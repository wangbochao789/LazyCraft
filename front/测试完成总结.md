# 🎉 Jest单元测试完成总结

## ✅ 测试结果

```bash
✅ Test Suites: 6 passed, 6 total
✅ Tests: 105 passed, 105 total
✅ Snapshots: 0 total
⏱️ Time: ~60 s
```

**状态：全部通过！** 🎊

---

## 📁 最终项目结构（源文件和测试文件完全分离）

```
front/
│
├── __mocks__/                                    ← Mock文件（统一管理）
│   ├── fileMock.js                              ← 静态文件Mock
│   └── next-navigation.ts                       ← Next.js路由Mock
│
├── __tests__/                                    ← 测试文件（和app平级）✨
│   ├── bind_phone/
│   │   └── normalForm.test.tsx                  ← 登录测试 (10个测试)
│   ├── register/
│   │   ├── captcha.test.tsx                     ← 验证码测试 (14个测试)
│   │   └── phone.test.tsx                       ← 注册测试 (22个测试)
│   ├── components/
│   │   └── taskStream/
│   │       └── resource-type-selector/
│   │           └── resource-types.test.tsx       ← 资源选择器测试 (25个测试) ✨
│   └── (appLayout)/
│       ├── datasets/
│       │   └── layout.test.tsx                     ← 数据集布局测试 (18个测试) ✨
│       └── tools/
│           └── Mcp/
│               └── page.test.tsx                   ← MCP工具页面测试 (17个测试) ✨ 新增
│
├── app/                                          ← 源代码（业务逻辑）
│   ├── bind_phone/
│   │   ├── normalForm.tsx                       ← 登录源文件
│   │   ├── page.tsx
│   │   └── page.module.scss
│   ├── register/
│   │   ├── captcha.tsx                          ← 验证码源文件
│   │   ├── phone.tsx                            ← 注册源文件
│   │   └── ...
│   └── ...
│
├── infrastructure/                               ← API和基础设施
├── shared/                                       ← 共享工具
│
├── jest.config.js                               ← Jest配置
├── jest.setup.js                                ← Jest环境设置
├── test-utils.tsx                               ← 测试工具
├── package.json                                 ← 包含测试脚本
└── README_TEST.md                               ← 测试文档
```

---

## 📊 测试覆盖统计

### 文件级别覆盖

| 源文件 | 测试文件 | 测试数量 | 状态 |
|--------|---------|---------|------|
| `app/bind_phone/normalForm.tsx` | `__tests__/bind_phone/normalForm.test.tsx` | 10 | ✅ |
| `app/register/captcha.tsx` | `__tests__/register/captcha.test.tsx` | 14 | ✅ |
| `app/register/phone.tsx` | `__tests__/register/phone.test.tsx` | 22 | ✅ |
| `app/components/taskStream/resource-type-selector/resource-types.tsx` | `__tests__/components/taskStream/resource-type-selector/resource-types.test.tsx` | 25 | ✅ |
| `app/(appLayout)/datasets/layout.tsx` | `__tests__/(appLayout)/datasets/layout.test.tsx` | 18 | ✅ |
| `app/(appLayout)/tools/Mcp/page.tsx` | `__tests__/(appLayout)/tools/Mcp/page.test.tsx` | 17 | ✅ |
| **总计** | **6个测试文件** | **105** | **✅** |

### 功能级别覆盖

#### 绑定手机号登录 (normalForm.tsx)
- ✅ 表单渲染
- ✅ 表单验证
- ✅ 登录成功流程
- ✅ 登录失败处理
- ✅ Loading状态
- ✅ OAuth参数处理
- ✅ 验证码集成

#### 用户注册 (phone.tsx)
- ✅ 所有字段渲染
- ✅ 用户名验证（英文数字30位以内）
- ✅ 邮箱验证
- ✅ 密码复杂度验证：
  - 长度8-30位
  - 必含小写字母
  - 必含大写字母
  - 必含数字
  - 必含特殊符号
- ✅ 确认密码验证
- ✅ 手机号格式验证
- ✅ 注册成功流程
- ✅ 注册失败处理
- ✅ 数据加密
- ✅ 消息提示

#### 验证码组件 (captcha.tsx)
- ✅ 输入框和按钮渲染
- ✅ 用户输入
- ✅ 获取验证码
- ✅ 倒计时功能（开始/禁用/结束）
- ✅ Loading状态
- ✅ 失败处理
- ✅ 错误状态显示和清除
- ✅ 自定义配置支持

#### 资源类型选择器 (resource-types.tsx) ✨
- ✅ 自定义工具列表渲染
- ✅ 自定义工具选择和搜索
- ✅ MCP插件工具Tab切换
- ✅ MCP工具展开/收起
- ✅ MCP子工具加载和显示
- ✅ Loading状态管理
- ✅ 子工具参数类型转换（6种类型）
- ✅ API缓存机制
- ✅ 搜索过滤功能
- ✅ Tab高亮状态
- ✅ UI交互（箭头、HoverTip）
- ✅ 错误处理

#### 数据集布局 (layout.tsx) ✨
- ✅ 侧边栏菜单渲染
- ✅ 数据集管理和脚本管理菜单项
- ✅ 路径状态同步（根据URL自动激活）
- ✅ 菜单点击切换路由
- ✅ 激活状态样式（active类名）
- ✅ 路径变化时状态更新
- ✅ 边界情况处理
- ✅ 组件结构验证

#### MCP工具页面 (page.tsx) ✨ 新增
- ✅ 组件渲染（MCP详情、服务创建方式、图标）
- ✅ 配置设置（传输类型、STDIO/SSE字段显示）
- ✅ 工具列表（显示、选择、空状态）
- ✅ 保存功能（配置保存）
- ✅ 发布功能（发布按钮显示、已发布状态）
- ✅ 表单验证（字段显示验证）
- ✅ 数据转换（stdio_env、headers对象转数组）
- ✅ 错误处理（API失败处理）

---

## 🎯 关键特性

### 1. 完全分离的文件结构 ✨

**源代码**：`front/app/`
```
app/
├── bind_phone/normalForm.tsx
└── register/
    ├── captcha.tsx
    └── phone.tsx
```

**测试代码**：`front/__tests__/`（和app平级）
```
__tests__/
├── bind_phone/normalForm.test.tsx
├── register/
│   ├── captcha.test.tsx
│   └── phone.test.tsx
└── components/
    └── taskStream/
        └── resource-type-selector/
            └── resource-types.test.tsx
```

**Mock代码**：`front/__mocks__/`
```
__mocks__/
├── fileMock.js
└── next-navigation.ts
```

### 2. 清晰的导入路径

```typescript
// 使用@别名导入源文件
import NormalForm from '@/app/bind_phone/normalForm'
import Captcha from '@/app/register/captcha'
import Register_phone from '@/app/register/phone'
import ResourceTypes from '@/app/components/taskStream/resource-type-selector/resource-types'

// 导入API
import * as commonApi from '@/infrastructure/api/common'
import * as toolmcpApi from '@/infrastructure/api/toolmcp'
```

### 3. 完善的Mock策略

```typescript
// Mock Next.js路由
jest.mock('next/navigation')

// Mock API调用
jest.mock('@/infrastructure/api/common')

// Mock复杂子组件
jest.mock('@/app/register/captcha')

// Mock第三方组件
jest.mock('@/app/components/base/iconFont')

// Mock复杂Hook
jest.mock('@/app/components/taskStream/resource-type-selector/hooks')
```

---

## 🚀 测试命令

```bash
# 进入front目录
cd front

# 运行所有测试
npm test

# 监听模式（文件改变自动重新测试）
npm run test:watch

# 生成覆盖率报告
npm run test:coverage

# CI环境运行
npm run test:ci
```

---

## 📖 测试文件详解

### 1. normalForm.test.tsx（登录测试）

**测试场景**：
1. ✅ 渲染所有表单元素
2. ✅ 手机号长度限制
3. ✅ 空表单验证
4. ✅ 手机号格式验证
5. ✅ 成功登录流程（API→token→跳转）
6. ✅ 登录失败处理
7. ✅ Loading状态
8. ✅ 缺少OAuth参数处理
9. ✅ 验证码功能
10. ✅ API参数正确性

**关键技术**：
- Mock Next.js的useRouter和useSearchParams
- Mock login API
- 验证localStorage操作
- 验证页面跳转

### 2. phone.test.tsx（注册测试）

**测试场景**：
1. ✅ 渲染所有必填字段
2. ✅ 用户名限制和格式
3. ✅ 邮箱格式验证
4. ✅ 密码长度验证
5. ✅ 密码必须包含小写字母
6. ✅ 密码必须包含大写字母
7. ✅ 密码必须包含数字
8. ✅ 密码必须包含特殊符号
9. ✅ 确认密码一致性
10. ✅ 手机号格式和长度
11. ✅ 成功注册流程（加密→API→消息→跳转）
12. ✅ 注册失败处理
13. ✅ Loading状态
14. ✅ URL参数自动填充
15. 等等...

**关键技术**：
- Mock ECDH加密
- Mock antd message组件
- 复杂表单验证测试
- 错误消息验证

### 3. captcha.test.tsx（验证码测试）

**测试场景**：
1. ✅ 渲染验证码输入框和按钮
2. ✅ 用户输入验证码
3. ✅ 获取验证码API调用
4. ✅ 倒计时开始
5. ✅ 倒计时期间按钮禁用
6. ✅ 倒计时结束按钮恢复
7. ✅ Loading状态
8. ✅ 失败时不开始倒计时
9. ✅ 自定义倒计时秒数
10. ✅ 验证错误状态显示
11. ✅ onChange清除错误
12. ✅ 自定义样式
13. ✅ Label属性
14. ✅ Required标记

**关键技术**：
- 使用jest.useFakeTimers控制时间
- jest.advanceTimersByTime快进时间
- Form.useForm包装器
- 异步状态测试

### 4. resource-types.test.tsx（资源类型选择器测试）✨

**测试场景**：

#### 自定义工具测试 (4个)
1. ✅ 渲染自定义工具列表
2. ✅ 点击工具调用onSelect回调
3. ✅ 搜索过滤功能
4. ✅ 空结果提示

#### MCP插件工具测试 (9个)
5. ✅ 切换到MCP工具Tab
6. ✅ 展开MCP工具并加载子工具列表
7. ✅ Loading状态显示
8. ✅ 收起子工具列表
9. ✅ 点击子工具传参正确
10. ✅ 子工具参数配置转换
11. ✅ 无子工具提示
12. ✅ 加载失败处理
13. ✅ 搜索过滤MCP工具

#### Tab切换测试 (2个)
14. ✅ 默认Tab高亮显示
15. ✅ 切换Tab高亮状态

#### MCP参数类型转换 (2个)
16. ✅ 转换6种参数类型（string/number/boolean/array/object/integer）
17. ✅ 处理空input_schema

#### 缓存机制 (1个)
18. ✅ 已加载的工具不重复调用API

#### 搜索功能 (2个)
19. ✅ 不区分大小写搜索
20. ✅ 空搜索显示全部

#### UI交互 (3个)
21. ✅ HoverTip显示
22. ✅ 展开时显示向上箭头
23. ✅ 收起时显示向下箭头

#### 其他功能 (2个)
24. ✅ 非工具类别不显示Tab
25. ✅ fromEmbedding过滤

**关键技术**：
- Mock复杂Hook（useResourceTypes）
- Mock API调用（getMcp）
- 测试展开/收起交互
- 测试异步加载和缓存
- 验证复杂数据转换
- Tab切换状态测试
- 参数类型映射测试

### 5. layout.test.tsx（数据集布局测试）✨

**测试场景**：

#### 菜单渲染测试 (2个)
1. ✅ 侧边栏菜单渲染
2. ✅ 子内容渲染

#### 路径状态同步测试 (3个)
3. ✅ 路径包含scriptManager时激活脚本管理
4. ✅ 路径为datasetManager时激活数据集管理
5. ✅ 路径变化时更新激活状态

#### 菜单点击切换测试 (3个)
6. ✅ 点击数据集管理切换路由
7. ✅ 点击脚本管理切换路由
8. ✅ 点击已激活菜单项的处理

#### 激活状态样式测试 (2个)
9. ✅ 激活菜单项有active类名
10. ✅ 未激活菜单项没有active类名

#### 边界情况测试 (3个)
11. ✅ 路径不包含scriptManager时默认激活数据集管理
12. ✅ 路径包含scriptManager时激活脚本管理
13. ✅ 空路径默认激活数据集管理

#### 组件结构测试 (2个)
14. ✅ 侧边栏和内容区域
15. ✅ 菜单项包含图标和文本

#### 交互流程测试 (2个)
16. ✅ 从数据集管理切换到脚本管理
17. ✅ 从脚本管理切换到数据集管理

#### 其他功能 (1个)
18. ✅ fromEmbedding过滤

**关键技术**：
- Mock Next.js路由（useRouter、usePathname）
- 异步状态测试（waitFor等待useEffect）
- 用户交互测试（userEvent）
- DOM元素查找（向上查找菜单项容器）
- CSS模块类名检查

### 6. page.test.tsx（MCP工具页面测试）✨ 新增

**测试场景**：

#### 组件渲染测试 (3个)
1. ✅ 正确渲染MCP详情页面
2. ✅ 显示服务创建方式卡片
3. ✅ 有图标时显示图标

#### 配置设置测试 (3个)
4. ✅ 显示传输类型选择
5. ✅ STDIO模式下显示相关字段
6. ✅ SSE模式下显示相关字段

#### 工具列表测试 (3个)
7. ✅ 显示工具列表
8. ✅ 能够选择工具
9. ✅ 无工具时显示空状态

#### 保存功能测试 (1个)
10. ✅ 能够保存配置

#### 发布功能测试 (2个)
11. ✅ 未发布时显示发布按钮
12. ✅ 已发布时显示更新发布和取消发布按钮

#### 表单验证测试 (2个)
13. ✅ STDIO模式下显示启动命令字段
14. ✅ SSE模式下显示服务端URL字段

#### 数据转换测试 (2个)
15. ✅ 正确转换stdio_env对象为数组
16. ✅ 正确转换headers对象为数组

#### 错误处理测试 (1个)
17. ✅ API调用失败时正常处理

**关键技术**：
- Mock Next.js路由（useRouter、useSearchParams）
- Mock API调用（getMcpDetail、getMcp、editMcp、publishMcp）
- Mock Ant Design组件（message、Card）
- Mock子组件（KeyValueList、McpToolTesting）
- 异步状态测试（waitFor、act）
- 表单验证测试
- 数据转换验证

---

**测试场景**（资源选择器重复部分）：

#### 自定义工具测试 (4个)
1. ✅ 渲染自定义工具列表
2. ✅ 点击工具调用onSelect回调
3. ✅ 搜索过滤功能
4. ✅ 空结果提示

#### MCP插件工具测试 (9个)
5. ✅ 切换到MCP工具Tab
6. ✅ 展开MCP工具并加载子工具列表
7. ✅ Loading状态显示
8. ✅ 收起子工具列表
9. ✅ 点击子工具传参正确
10. ✅ 子工具参数配置转换
11. ✅ 无子工具提示
12. ✅ 加载失败处理
13. ✅ 搜索过滤MCP工具

#### Tab切换测试 (2个)
14. ✅ 默认Tab高亮显示
15. ✅ 切换Tab高亮状态

#### MCP参数类型转换 (2个)
16. ✅ 转换6种参数类型（string/number/boolean/array/object/integer）
17. ✅ 处理空input_schema

#### 缓存机制 (1个)
18. ✅ 已加载的工具不重复调用API

#### 搜索功能 (2个)
19. ✅ 不区分大小写搜索
20. ✅ 空搜索显示全部

#### UI交互 (3个)
21. ✅ HoverTip显示
22. ✅ 展开时显示向上箭头
23. ✅ 收起时显示向下箭头

#### 其他功能 (2个)
24. ✅ 非工具类别不显示Tab
25. ✅ fromEmbedding过滤

**关键技术**：
- Mock复杂Hook（useResourceTypes）
- Mock API调用（getMcp）
- 测试展开/收起交互
- 测试异步加载和缓存
- 验证复杂数据转换
- Tab切换状态测试
- 参数类型映射测试

---

## 💡 技术亮点

### 1. 目录镜像结构
```
app/bind_phone/normalForm.tsx
  ↓ 镜像
__tests__/bind_phone/normalForm.test.tsx
```

### 2. 绝对路径导入
```typescript
// ✅ 使用@别名，清晰明了
import Component from '@/app/path/Component'

// ❌ 避免相对路径
import Component from '../../../app/path/Component'
```

### 3. 统一的Mock管理
```
__mocks__/
  ├── next-navigation.ts    ← 路由Mock
  └── fileMock.js          ← 文件Mock
```

### 4. 自动发现测试
Jest自动扫描 `__tests__/` 目录下的所有 `*.test.tsx` 文件，无需手动配置！

### 5. 组件测试模式
```
app/components/xxx/Component.tsx
  ↓ 镜像
__tests__/components/xxx/Component.test.tsx
```

---

## 🔧 配置文件说明

### jest.config.js
- ✅ 使用Next.js的Jest配置
- ✅ 支持TypeScript和TSX
- ✅ CSS模块Mock
- ✅ 路径别名(@/)
- ✅ 覆盖率收集配置

### jest.setup.js
- ✅ Mock浏览器API
- ✅ Mock localStorage
- ✅ 过滤警告信息
- ✅ 导入jest-dom匹配器

### package.json
```json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:ci": "jest --ci --coverage --maxWorkers=2"
  }
}
```

---

## 📈 下一步建议

### 扩展测试覆盖
1. 为signin（登录页面）添加测试
2. 为其他关键组件添加测试（已有资源选择器测试 ✨）
3. 添加集成测试
4. 添加E2E测试

### 提高测试质量
1. 增加边界情况测试
2. 增加错误处理测试
3. 提高代码覆盖率到80%+
4. 添加性能测试

### CI/CD集成
1. 在GitHub Actions中运行测试
2. PR时自动运行测试
3. 生成覆盖率报告
4. 阻止覆盖率下降的PR

---

## 🎓 学到的内容

### 测试编写技巧
- ✅ AAA模式（Arrange-Act-Assert）
- ✅ Mock外部依赖
- ✅ 异步测试（waitFor）
- ✅ 用户事件模拟（userEvent）
- ✅ 语义化查询（getByRole）

### Jest特性
- ✅ 假计时器（jest.useFakeTimers）
- ✅ Mock函数（jest.fn）
- ✅ Mock模块（jest.mock）
- ✅ 生命周期钩子（beforeEach/afterEach）

### React Testing Library
- ✅ render组件
- ✅ screen查询
- ✅ 用户交互
- ✅ 异步等待

---

## 📦 创建的文件清单

### 配置文件
- ✅ `jest.config.js` - Jest配置
- ✅ `jest.setup.js` - 测试环境设置
- ✅ `test-utils.tsx` - 测试工具函数

### Mock文件（`__mocks__/`）
- ✅ `fileMock.js` - 静态文件Mock
- ✅ `next-navigation.ts` - Next.js路由Mock

### 测试文件（`__tests__/`）
- ✅ `bind_phone/normalForm.test.tsx` - 登录测试(10个)
- ✅ `register/captcha.test.tsx` - 验证码测试(14个)
- ✅ `register/phone.test.tsx` - 注册测试(22个)
- ✅ `components/taskStream/resource-type-selector/resource-types.test.tsx` - 资源选择器测试(25个) ✨
- ✅ `(appLayout)/datasets/layout.test.tsx` - 数据集布局测试(18个) ✨
- ✅ `(appLayout)/tools/Mcp/page.test.tsx` - MCP工具页面测试(17个) ✨ 新增

### 文档文件
- ✅ `README_TEST.md` - 测试使用文档
- ✅ `测试完成总结.md` - 本文档

### package.json更新
```json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:ci": "jest --ci --coverage --maxWorkers=2"
  }
}
```

---

## 🎯 实现的需求

### ✅ 需求1：使用Jest编写单元测试
- 已安装Jest和相关依赖
- 已配置Jest环境
- 已编写88个测试用例

### ✅ 需求2：针对登录和注册页面
- **登录页面**：`normalForm.tsx` → 10个测试
- **注册页面**：`phone.tsx` → 22个测试
- **验证码组件**：`captcha.tsx` → 14个测试
- **资源选择器**：`resource-types.tsx` → 25个测试 ✨
- **数据集布局**：`layout.tsx` → 18个测试 ✨
- **MCP工具页面**：`page.tsx` → 17个测试 ✨ 新增

### ✅ 需求3：测试代码和源文件明确分开
```
✅ 源代码：front/app/
✅ 测试代码：front/__tests__/（和app平级）
✅ Mock代码：front/__mocks__/
```

### ✅ 需求4：测试放在front文件夹下和app平级
```
front/
├── __tests__/  ← 测试目录
├── __mocks__/  ← Mock目录
└── app/        ← 源码目录
```

**完全符合你的要求！** ✨

---

## 🚀 快速开始

### 运行测试
```bash
cd front
npm test
```

### 查看测试文件
```bash
# 测试文件都在这里
front/__tests__/
```

### 添加新测试
```bash
# 1. 在__tests__下创建对应目录
front/__tests__/新功能/

# 2. 创建测试文件
front/__tests__/新功能/Component.test.tsx

# 3. 导入源文件（使用@别名）
import Component from '@/app/新功能/Component'
```

---

## 📝 测试示例

### 基础渲染测试
```typescript
test('应该正确渲染', () => {
  render(<Component />)
  expect(screen.getByText('标题')).toBeInTheDocument()
})
```

### 用户交互测试
```typescript
test('点击按钮', async () => {
  const user = userEvent.setup()
  render(<Component />)
  
  await user.click(screen.getByRole('button'))
  
  expect(mockApi).toHaveBeenCalled()
})
```

### 表单验证测试
```typescript
test('验证错误', async () => {
  render(<Form />)
  
  await user.click(screen.getByRole('button', { name: '提交' }))
  
  await waitFor(() => {
    expect(screen.getByText('请输入用户名')).toBeInTheDocument()
  })
})
```

---

## 🎓 核心概念

### Mock（模拟）
用假的实现替换真实的依赖，使测试更快、更可控。

```typescript
// Mock API
jest.mock('@/infrastructure/api/common', () => ({
  login: jest.fn().mockResolvedValue({ success: true }),
}))
```

### Assert（断言）
验证代码是否按预期工作。

```typescript
expect(element).toBeInTheDocument()
expect(mockFn).toHaveBeenCalled()
expect(value).toBe(expected)
```

### Async Testing（异步测试）
等待异步操作完成。

```typescript
await waitFor(() => {
  expect(screen.getByText('成功')).toBeInTheDocument()
})
```

---

## ⚠️ 注意事项

### Console警告
测试输出中的这些警告可以忽略：
- ✅ `Warning: An update to... was not wrapped in act(...)` - 已过滤
- ✅ `Warning: callback is deprecated` - 已过滤
- ℹ️ `Missing openid or provider parameters` - 测试预期内的错误

### 测试隔离
- 每个测试前调用 `jest.clearAllMocks()`
- 每个测试后调用 `jest.restoreAllMocks()`
- 确保测试之间互不影响

### 假计时器
- Captcha测试使用假计时器
- 记得在afterEach中恢复：`jest.useRealTimers()`

---

## 📚 参考文档

- [Jest官方文档](https://jestjs.io/)
- [React Testing Library](https://testing-library.com/react)
- [Testing Library 查询指南](https://testing-library.com/docs/queries/about)
- [User Event API](https://testing-library.com/docs/user-event/intro)

---

## ✨ 总结

**你现在拥有一个完整、专业、易维护的Jest测试环境！**

✅ **结构清晰**：源码、测试、Mock完全分离  
✅ **覆盖全面**：登录、注册、验证码、资源选择器、数据集布局、MCP工具页面全覆盖  
✅ **测试充分**：105个测试用例  
✅ **质量保证**：100%测试通过  
✅ **易于扩展**：清晰的文件组织和示例  
✅ **文档完善**：README和总结文档  

**开始你的测试驱动开发之旅吧！** 🚀

---

**创建时间**：2024-11-18  
**最后更新**：2024-12-XX  
**测试状态**：✅ 全部通过（105/105）  
**维护建议**：每次添加新功能时，同步添加测试

---

## 🆕 最新更新

### MCP工具页面测试 (2024-12-XX) ✨

新增了MCP工具页面的完整单元测试，包含17个核心功能测试：

- ✅ 组件渲染测试（3个）
- ✅ 配置设置测试（3个）
- ✅ 工具列表测试（3个）
- ✅ 保存功能测试（1个）
- ✅ 发布功能测试（2个）
- ✅ 表单验证测试（2个）
- ✅ 数据转换测试（2个）
- ✅ 错误处理测试（1个）

**测试文件位置**：`__tests__/(appLayout)/tools/Mcp/page.test.tsx`  
**源文件位置**：`app/(appLayout)/tools/Mcp/page.tsx`

**特点**：
- 专注于核心功能验证
- 移除非核心的复杂交互测试
- 使用 `fireEvent` 和 `act` 确保异步状态更新
- 完善的Mock策略（API、路由、组件）

